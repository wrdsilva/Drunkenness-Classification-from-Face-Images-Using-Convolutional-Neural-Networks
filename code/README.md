# Source code for producing the results and figures

The code is divided between Python scripts and Jupyter notebooks. The scripts implement functions for processing the database and analyzing the frame sequence of each subject. In this sense, the first step for reproducing our work is running the `multiframe_preprocessing.py` script. This script will retrieve individual frames from each multi-page .tiff file and convert them to the RGB color space, since the VGG16 pre-trained model expects images with 3 color channels. In addition, this script will return the balanced and imbalanced datasets used along the experiments described in the paper. The `frame_histogram.py` script implement functions for performing the thermogram subtraction analysis (showed in paper's *Dataset description* subsection), the histogram comparison and the PSNR analysis (showed in paper's *Inference interpretation* subsection).

The notebooks implement the training and evaluation functions described throughout the paper's *Training strategy* subsection. Once the dataset is properly preprocessed, the next step is running the `multiframe-cc-base-model-random-search.ipynb` notebook. This notebook will return the possible hyperparameter sets for training the base model. Then, use the most promissing hyperparameter set showed in paper's *Results* section to perform the transfer learning (by executing the `multiframe-cc-base-model-transfer-learning.ipynb` notebook). If everthing goes well, the next step is fine-tuning the base model using the notebook `multiframe-cc-base-model-fine-tuning.ipynb`. This notebook contains two functions: `hyperparameter_search()` and `fine_tuning()`. The former is used for finding the most promissing values for the fine-tuning hyperparameters, whereas the latter implements the fine-tuning using the hyperparameters described in paper's *Results* section.

Once you obtain the fine-tuned base model, the next step is training the final model by executing the `multiframe-cc-final-model-transfer-learning.ipynb` notebook. Notice that this notebook contains two functions: `hyperparameter_search()` and `fine_tuning()`. The former is used for finding the most promissing training hyperparameters, whereas the latter implements the transfer learning using the hyperparameters described in paper's *Results* section. Lastly, you just need to run the `multiframe-cc-final-model-fine-tuning.ipynb` notebook to obtain the fine-tuned final model.

The `multiframe-cc-face-symmetry.ipynb` notebook contains all implementations required for performing the Mann-Whitney test and the following analysis described in paper's *Inference interpretation* subsection. All implementations related to the grad-cam analysis showed in paper's *Inference interpretation* subsection are available in the `multiframe-cc-final-model-grad-cam.ipynb` notebook.

